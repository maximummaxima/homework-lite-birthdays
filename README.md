# Проект №3 (Lite) «Анализатор логов»

Это **упрощённая** версия ДЗ: меньше параметров CLI, меньше форматов вывода и меньше метрик.

## 1. Цель
Сделать консольную утилиту, которая анализирует **NGINX access logs** и пишет отчёт в **JSON**.

## 2. Требования

### 2.1. Параметры командной строки
Поддерживаются только два обязательных параметра:

- `--path, -p` — путь к **одному или нескольким локальным** лог-файлам.
  - допускаются glob-шаблоны (например: `logs/*.txt`)
  - поддерживаемые расширения: `.txt`, `.log`
  - если файл не найден / расширение не поддерживается — завершать программу с кодом **2**

- `--output, -o` — путь к выходному файлу с отчётом.
  - расширение **строго** `.json`
  - если файл уже существует — завершать программу с кодом **2**
  - если директория недоступна для записи — завершать программу с кодом **2**

Другие параметры в lite-версии **не поддерживаются** (при наличии неизвестного параметра — код **2**).

Коды завершения:
- `0` — успешно
- `1` — непредвиденная ошибка
- `2` — ошибка использования (аргументы/файлы)

Пример запуска:

```bash
java -jar log-analyzer.jar -p logs/*.txt -o report.json
```

### 2.2. Формат входных данных
Обрабатываем строки NGINX в формате:

```
'$remote_addr - $remote_user [$time_local] ' '"$request" $status $body_bytes_sent ' '"$http_referer" "$http_user_agent"'
```

Если строка не парсится — залогировать WARN и **пропустить**.

### 2.3. Что посчитать
По всем корректным строкам собрать:

1) `totalRequestsCount` — общее число запросов

2) `responseSizeInBytes`:
- `average` — средний размер ответа
- `max` — максимальный размер ответа

3) `responseCodes` — количество ответов по HTTP-кодам

4) `resources` — топ-5 ресурсов по количеству запросов
- ресурс — это только путь (`/downloads/product_1`), без метода и версии протокола

Округление: `average` хранить с точностью **2 знака** после запятой.

## 3. Формат вывода (JSON)
Выходной файл должен соответствовать структуре:

```json
{
  "files": ["access.log"],
  "totalRequestsCount": 100,
  "responseSizeInBytes": {
    "average": 123.45,
    "max": 999.0
  },
  "resources": [
    { "resource": "/downloads/product_1", "totalRequestsCount": 10 }
  ],
  "responseCodes": [
    { "code": 200, "totalResponsesCount": 90 }
  ]
}
```

Для lite-версии **никаких markdown/adoc**, **никаких дат**, **никаких p95/доп. метрик**.

## 4. Проверка
В репозитории есть black-box acceptance тесты:

```bash
bash scripts/run_acceptance_tests.sh
```

(они собирают Docker-образ и гоняют сценарии запуска утилиты).
